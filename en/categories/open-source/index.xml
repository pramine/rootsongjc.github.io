<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Jimmy Song - Cloud Native | Open Source | Community â€“ Open Source</title>
    <link>https://jimmysong.io/en/categories/open-source/</link>
    <description>Recent content in Open Source on Jimmy Song - Cloud Native | Open Source | Community</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>Copyright &amp;copy; 2020 Jimmy Song All Right Reserved; Powerd by Hugo with [educenter](https://github.com/themefisher/educenter-hugo) theme</copyright>
    <lastBuildDate>Fri, 18 Jan 2019 19:06:14 +0800</lastBuildDate>
    
	  <atom:link href="https://jimmysong.io/en/categories/open-source/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title>Cloud Native Sandbox</title>
      <link>https://jimmysong.io/en/blog/cloud-native-sandbox/</link>
      <pubDate>Fri, 18 Jan 2019 19:06:14 +0800</pubDate>
      
      <guid>https://jimmysong.io/en/blog/cloud-native-sandbox/</guid>
      <description>
        
        
        

&lt;p&gt;Github: &lt;a href=&#34;https://github.com/rootsongjc/cloud-native-sandbox&#34;&gt;https://github.com/rootsongjc/cloud-native-sandbox&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Cloud Native Sandbox can help you setup a standalone Kubernetes and istio environment with Docker on you own laptop.&lt;/p&gt;

&lt;p&gt;The sandbox integrated with the following components:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Kubernetes v1.10.3&lt;/li&gt;
&lt;li&gt;Istio v1.0.4&lt;/li&gt;
&lt;li&gt;Kubernetes dashboard v1.8.3&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;differences-with-kubernetes-vagrant-centos-cluster&#34;&gt;Differences with kubernetes-vagrant-centos-cluster&lt;/h2&gt;

&lt;p&gt;As I have created the &lt;a href=&#34;https://github.com/rootsongjc/kubernetes-vagrant-centos-cluster&#34;&gt;kubernetes-vagrant-centos-cluster&lt;/a&gt; to set up a Kubernetes cluster and istio service mesh with &lt;code&gt;vagrantfile&lt;/code&gt; which consists of 1 master(also as node) and 3 nodes, but there is a big problem that it is so high weight and consume resources. So I made this light weight sandbox.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Features&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;No VirtualBox or Vagrantfile  required&lt;/li&gt;
&lt;li&gt;Light weight&lt;/li&gt;
&lt;li&gt;High speed, low drag&lt;/li&gt;
&lt;li&gt;Easy to operate&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Services&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;As the sandbox setup, you will get the following services.&lt;/p&gt;

&lt;p align=&#34;center&#34;&gt;
    &lt;img src=&#34;https://jimmysong.io/img/cloud-native-sandbox.svg&#34; alt=&#34;Cloud Native Sandbox&#34;&gt;
&lt;/p&gt;

&lt;p&gt;Record with &lt;a href=&#34;https://github.com/nbedos/termtosvg&#34;&gt;termtosvg&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;prerequisite&#34;&gt;Prerequisite&lt;/h2&gt;

&lt;p&gt;You only need a laptop with Docker Desktop installed and &lt;a href=&#34;https://docs.docker.com/docker-for-mac/#kubernetes&#34;&gt;Kubernetes enabled&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Note: Leave enough resources for Docker Desktop. At least 2 CPU, 4G memory.&lt;/p&gt;

&lt;h2 id=&#34;install&#34;&gt;Install&lt;/h2&gt;

&lt;p&gt;To start the sandbox, you have to run the following steps.&lt;/p&gt;

&lt;h3 id=&#34;kubernetes-dashboard-optional&#34;&gt;Kubernetes dashboard(Optional)&lt;/h3&gt;

&lt;p&gt;Install Kubernetes dashboard.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;kubectl apply -f install/dashbaord/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Get the dashboard token.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;kubectl -n kube-system describe secret default| awk &#39;$1==&amp;quot;token:&amp;quot;{print $2}&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Expose &lt;code&gt;kubernetes-dashboard&lt;/code&gt; service.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;kubectl -n kube-system get pod -l k8s-app=kubernetes-dashboard -o jsonpath=&#39;{.items[0].metadata.name}&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Login to Kubernetes dashboard on &lt;a href=&#34;http://localhost:8001/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy/#!/login&#34;&gt;http://localhost:8001/api/v1/namespaces/kube-system/services/https:kubernetes-dashboard:/proxy/#!/login&lt;/a&gt; with the above token.&lt;/p&gt;

&lt;h3 id=&#34;istio-required&#34;&gt;Istio(Required)&lt;/h3&gt;

&lt;p&gt;Install istio service mesh with the default add-ons.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# Install istio
kubectl apply -f install/istio/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To expose service &lt;code&gt;grafana&lt;/code&gt; on &lt;a href=&#34;http://localhost:3000&#34;&gt;http://localhost:3000&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;kubectl -n istio-system port-forward $(kubectl -n istio-system get pod -l app=grafana -o jsonpath=&#39;{.items[0].metadata.name}&#39;) 3000:3000 &amp;amp;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To expose service &lt;code&gt;prometheus&lt;/code&gt; on &lt;a href=&#34;http://localhost:9090&#34;&gt;http://localhost:9090&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;kubectl -n istio-system port-forward $(kubectl -n istio-system get pod -l app=prometheus -o jsonpath=&#39;{.items[0].metadata.name}&#39;) 9090:9090 &amp;amp;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To expose service &lt;code&gt;jaeger&lt;/code&gt; on &lt;a href=&#34;http://localhost:16686&#34;&gt;http://localhost:16686&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;kubectl -n istio-system port-forward $(kubectl -n istio-system get pod -l app=jaeger -o jsonpath=&#39;{.items[0].metadata.name}&#39;) 16686:16686 &amp;amp;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To expose service &lt;code&gt;servicegraph&lt;/code&gt; on &lt;a href=&#34;http://localhost:8088/dotviz&#34;&gt;http://localhost:8088/dotviz&lt;/a&gt;, &lt;a href=&#34;http://localhost:8088/force/forcegraph.html&#34;&gt;http://localhost:8088/force/forcegraph.html&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;kubectl -n istio-system port-forward $(kubectl -n istio-system get pod -l app=servicegraph -o jsonpath=&#39;{.items[0].metadata.name}&#39;) 8088:8088 &amp;amp;
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;kiali&#34;&gt;Kiali&lt;/h3&gt;

&lt;p&gt;Install &lt;a href=&#34;https://www.kiali.io/&#34;&gt;kiali&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;kubectl -n istio-system apply -f install/kiali
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To expose service &lt;code&gt;kiali&lt;/code&gt; on &lt;a href=&#34;http://localhost:20001&#34;&gt;http://localhost:20001&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;kubectl -n istio-system port-forward $(kubectl -n istio-system get pod -l app=kiali -o jsonpath=&#39;{.items[0].metadata.name}&#39;) 20001:20001 &amp;amp;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;bookinfo-sample&#34;&gt;Bookinfo sample&lt;/h2&gt;

&lt;p&gt;Deploy &lt;a href=&#34;https://istio.io/docs/examples/bookinfo/&#34;&gt;bookinfo sample&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;# Enable sidecar auto injection
kubectl label namespace default istio-injection=enabled
# Deploy bookinfo sample
kubectl -n default apply -f sample/bookinfo
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Visit &lt;code&gt;productpage&lt;/code&gt; on &lt;a href=&#34;http://localhost/productpage&#34;&gt;http://localhost/productpage&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Let&amp;rsquo;s generate some loads.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;for ((i=0;i&amp;lt;1000;i=i+1));do echo &amp;quot;Step-&amp;gt;$i&amp;quot;;curl http://localhost/productpage;done
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You can watch the service status through &lt;a href=&#34;http://localhost:3000&#34;&gt;http://localhost:3000&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;client-tools&#34;&gt;Client tools&lt;/h2&gt;

&lt;p&gt;To operate the applications on Kubernetes, you should install the following tools.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Required&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/tools/install-kubectl/&#34;&gt;kubectl&lt;/a&gt; - Deploy and manage applications on Kubernetes.&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://istio.io/docs/reference/commands/istioctl/&#34;&gt;istioctl&lt;/a&gt; - Istio configuration command line utility.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Optional&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/ahmetb/kubectx&#34;&gt;kubectx&lt;/a&gt;  - Switch faster between clusters and namespaces in kubectl&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/jonmosco/kube-ps1&#34;&gt;kube-ps1&lt;/a&gt; - Kubernetes prompt info for bash and zsh&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
  </channel>
</rss>
